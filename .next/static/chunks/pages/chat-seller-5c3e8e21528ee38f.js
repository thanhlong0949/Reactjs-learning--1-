(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[842],{52166:function(e,s,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/chat-seller",function(){return n(90591)}])},90591:function(e,s,n){"use strict";n.r(s),n.d(s,{default:function(){return w}});var a=n(85893),t=n(67294),c=(n(9477),n(47359)),i=n(29815),r=n(71511),l=n(87547),u=n(68795),o=n(37446),d=n(76971),m=n(27496),v=n(11163),f=(n(2013),n(24016)),h=n(28e3),N=n.n(h),p=n(54774),j=n(9473),x=null;function g(){var e=(0,j.v9)((function(e){return e.user})),s=(0,t.useState)(""),n=s[0],c=s[1],h=(0,t.useState)(""),g=h[0],w=h[1],_=(0,t.useState)(new Map),Z=_[0],E=_[1],S=(0,v.useRouter)(),b=S.query.seller;console.log("stompClient",x);var y=function(){x.subscribe("/user/"+e.name+"/private",O),M()},M=function(){var s={senderName:e.name,status:"JOIN"};x.send("/app/message",{},JSON.stringify(s))},O=function(e){console.log("onPrivateMessage",e);var s=JSON.parse(e.body);if(Z.get(s.senderName))Z.get(s.senderName).push(s),E(new Map(Z));else{var n=[];n.push(s),Z.set(s.senderName,n),E(new Map(Z))}},k=function(e){console.log("err",e)};return(0,t.useEffect)((function(){c(b),Z.get(b)||(Z.set(b,[]),E(new Map(Z)))}),[S.query]),(0,t.useEffect)((function(){n&&function(){var e=new(N())("https://lobster-app-uadur.ondigitalocean.app/ws");(x=(0,p.over)(e)).connect({},y,k)}()}),[n]),(0,a.jsxs)("div",{className:"content-chat",children:[(0,a.jsxs)("div",{className:"nav-chat",children:[(0,a.jsxs)("div",{className:"nav-left",children:[(0,a.jsx)(r.Z,{icon:(0,a.jsx)(l.Z,{})}),(0,a.jsx)("div",{className:"name",children:n})]}),(0,a.jsxs)("div",{className:"nav-right",children:[(0,a.jsx)(u.Z,{}),(0,a.jsx)(o.Z,{})]})]}),(0,a.jsx)("div",{className:"content-chat-mess",children:Z.get(n)?(0,i.Z)(Z.get(n)).map((function(s,n){return s.senderName===e.name?(0,a.jsx)("div",{className:"mess-right",children:(0,a.jsx)("div",{className:"des-mess",children:s.message})}):(0,a.jsx)("div",{className:"mess-left",children:(0,a.jsxs)("div",{className:"mess-main",children:[(0,a.jsx)(r.Z,{icon:(0,a.jsx)(l.Z,{})}),(0,a.jsx)("div",{className:"des-mess",children:s.message})]})})})):(0,a.jsx)("div",{})}),(0,a.jsxs)("div",{className:"control-mess",children:[(0,a.jsx)(d.Z,{}),(0,a.jsx)(f.Z,{size:"small",placeholder:"Type a message...",value:g,onChange:function(e){w(e.target.value)}}),(0,a.jsx)(m.Z,{onClick:function(){g&&function(){if(x){var s={senderName:e.name,receiverName:n,message:g,status:"MESSAGE"};e.name!==n&&(Z.get(n).push(s),E(new Map(Z))),x.send("/app/private-message",{},JSON.stringify(s)),w("")}}()}})]})]})}function w(){return(0,a.jsxs)("div",{className:"chat-seller",children:[(0,a.jsx)(c.Z,{}),(0,a.jsx)("div",{className:"chat-seller-main",children:(0,a.jsx)("div",{className:"chat-seller-body",children:(0,a.jsx)(g,{})})})]})}},2013:function(){},9477:function(){}},function(e){e.O(0,[222,774,888,179],(function(){return s=52166,e(e.s=s);var s}));var s=e.O();_N_E=s}]);